%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Since : 2019/04/03
%Update: 2019/04/03
% -*- coding: utf-8 -*-
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{Excelによる統計処理2}

\section{目的}

データを解析おいて重要なデータの可視化(グラフ化)の方法を学ぶ．

\section{原理}

\subsection{グラフ}

データの特徴を視覚的に把握するためにグラフを用います．
代表的なグラフの一つが前回取り扱ったヒストグラムです．
ヒストグラム以外にも様々なグラフが存在します．
今回は，折れ線グラフ，円グラフ，散布図を取り扱います．

\paragraph{棒グラフ}

棒グラフは大きさの比較に用いられます．
時間変化を把握するのに用いてはいけません．

\paragraph{折れ線グラフ}

値の時間変化の把握に用いられます．
大きさを比べる目的で折れ線グラフを使わないようにしましょう．

\paragraph{円グラフ}

割合をは把握するために用いられます．
扇型の角度は全体に対する割合を表します．
円グラフは合計で100\%にならなければなりません．

例えば，表\ref{tab:hist}

\paragraph{散布図}

データの値同士の関係性を知りたいときがあります．
値の関係性を見るために用いられます．
例として，前回の演習で用いたアヤマのがく片の長さと幅 (iris.csv)の散布図(図\ref{fig:scatter})を示します．
散布図は関係を見るデータ，例ではアヤメのがく片の長さと幅，をそれぞれ軸とします．
そして，データの組み合わせ，例ではアヤメのがく片の長さと幅，を点で表します．
例の散布図を見ると，がく片の長さが長いほど幅が太くなる傾向がありそうなことが分かります．
データそれぞれ無関係な場合は，点は垂直，水平，円に分布します．


\begin{figure}[htbp]
    \centering
    \includegraphics[width=6cm]{chap2/scatter.png}
    \caption{散布図}
    \label{fig:scatter}
\end{figure}

\subsection{相関係数}

散布図では，視覚的に値同士の関係性を見ることができます．
しかし，定量的にどの程度関係しているか知りたいときには相関係数を使います．
相関係数は次の式で計算されます．
\begin{equation}
    \label{eq:1}
    r = \frac{\frac{1}{N} \sum_{i=1}^N (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\frac{1}{N} \sum_{i=1}^N (x_i - \bar{x})^2} \sqrt{\frac{1}{N} \sum_{i=1}^N(y_i - \bar{y})^2}}
\end{equation}
相関係数は直線的な関係かどうかをみることができます．
しかし，U字型であったりS字型の関係であった場合は相関係数ではみることができません．

相関係数が正の場合は正の相関
負の相関

\subsection{散布図と回帰直線}

平均に戻る．回帰．


\section{演習}

\subsection{}


\begin{figure}[htbp]
    \begin{minipage}{0.5\hsize}
        \centering
        \includegraphics[width=6cm]{chap2/bar1.png}
        \caption{}
        \label{fig:bar1}
    \end{minipage}
    \begin{minipage}{0.5\hsize}
        \centering
        \includegraphics[width=6cm]{chap2/bar2.png}
        \caption{}
        \label{fig:bar2}
    \end{minipage}
\end{figure}


\subsection{折れ線グラフ}

手順は前回のヒストグラムと同じです．

\paragraph{演習}
csvファイルから折れ線グラフを作りなさい．ただし，横軸は 縦軸は にしなさい．

\subsection{円グラフ}

\paragraph{演習}


\subsection{折れ線グラフ}

表に示すデータを折れ線グラフにします．
横軸を，縦軸をとします．
よく軸のデータと縦軸のデータを選びます．
グラフの散布図の折れ線グラフを選びます．

\paragraph{演習}
csvファイルから折れ線グラフを作りなさい．ただし，横軸は 縦軸は にしなさい．


\subsection{散布図}

\paragraph{演習}

csvファイルから散布図をかきなさい．ただし，横軸は 縦軸は にしなさい．


\subsection{相関係数}

Excelで相関係数を求めるのは簡単です．前回の総和を求めたのと同じ要領で行います．しかし，今回は2列データがありますので，そこだけ注意しましょう．

CORREL

\paragraph{演習}
csvデータから相関係数を求めなさい．

\subsection{回帰直線}



\paragraph{演習}

csvデータから散布図と回帰直線をかきなさい．


\subsection{レポート提出}

レポートはkazuhisa.fujita@komatsu-u.ac.jpへ電子データとして提出する．データ形式はpdfとする．レポートの提出期限は次回の講義日までとする．

\section{おまけ}

R，python

プロット
R，matplotlib，gnuplot


有料ならmatlabがある．
